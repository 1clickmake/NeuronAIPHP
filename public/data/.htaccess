# Prevent script execution in upload directory
# Security: Whitelist approach - Deny everything, Allow only safe extensions

# Disable directory listing
Options -Indexes

# Default Deny
Order Deny,Allow
Deny from all

# Allow only safe extensions
<FilesMatch "\.(jpg|jpeg|png|gif|webp|pdf|doc|docx|xls|xlsx|txt|zip|ppt|pptx)$">
    Order Deny,Allow
    Allow from all
</FilesMatch>

# Prevent access to .htaccess
<Files ~ "^\.ht">
    Order allow,deny
    Deny from all
</Files>
